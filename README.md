ะะพั ะฐะดะฐะฟัะธัะพะฒะฐะฝะฝัะน `README.md` ะฟะพะด ะดะพะผะฐัะฝะตะต ะทะฐะดะฐะฝะธะต ั ะฒะตัะธัะธะบะฐัะธะตะน email, ั ัะพััะฐะฝะตะฝะธะตะผ ะฐััะธัะตะบัััะฝะพะณะพ ััะธะปั ะฟัะตะดัะดััะตะณะพ ะฟัะพะตะบัะฐ:

---

# ๐ง ะะพะผะฐัะฝะตะต ะทะฐะดะฐะฝะธะต โ6 โ ะะตัะธัะธะบะฐัะธั Email ะธ ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ ะฝะฐะณััะทะบะธ

## ๐ฆ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะฃัะตะฑะฝัะน ะฟัะพะตะบั ะดะปั ะทะฐะบัะตะฟะปะตะฝะธั ะฟัะฐะบัะธัะตัะบะธั ะฝะฐะฒัะบะพะฒ ัะฐะฑะพัั ั Docker, PHP-FPM, Nginx, Redis Cluster ะธ ััะพะฝัะตะฝะดะพะผ ะฝะฐ Vue.js.

ะัะฝะพะฒะฝะฐั ะทะฐะดะฐัะฐ โ ัะตะฐะปะธะทะพะฒะฐัั ะฒะตะฑ-ัะตัะฒะธั, ะฟัะธะฝะธะผะฐััะธะน ัะฟะธัะพะบ email-ะฐะดัะตัะพะฒ ัะตัะตะท POST-ะทะฐะฟัะพั, ะฟัะพะฒะตััััะธะน ะธั ะบะพััะตะบัะฝะพััั ั ัะพัะบะธ ะทัะตะฝะธั ัะพัะผะฐัะฐ ะธ ะฝะฐะปะธัะธั DNS-ะทะฐะฟะธัะธ ัะธะฟะฐ MX.

ะัะพะตะบั ะฟะพัััะพะตะฝ ะฝะฐ ะผะธะบัะพัะตัะฒะธัะฝะพะน ะฐััะธัะตะบัััะต ั ัะฐะทะดะตะปะตะฝะธะตะผ ะฝะฐ:

โ ะฑะฐะปะฐะฝัะธัะพะฒัะธะบ (nginx upstream)
โ ะดะฒะฐ backend-ะฐ (nginx + php-fpm)
โ Redis Cluster ะดะปั ััะฐะฝะตะฝะธั ัะตััะธะน ะธ ััะฐัะธััะธะบะธ
โ frontend-ะฟัะธะปะพะถะตะฝะธะต (Vue + Vite), ะฟัะตะดะพััะฐะฒะปัััะตะต ะฒะตะฑ-ัะพัะผั ะดะปั ะฟัะพะฒะตัะบะธ

## ๐งฑ ะกัะตะบ ัะตัะฝะพะปะพะณะธะน

* PHP 8.3 (FPM)
* Nginx (ะฑะฐะปะฐะฝัะธัะพะฒัะธะบ ะธ backend)
* Redis Cluster (ะดะปั ัะตััะธะน ะธ ััะฐัะธััะธะบะธ)
* Docker / Docker Compose
* Composer (PSR-4 autoload)
* Vue 3 + Vite + Axios

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
otus-php-hw06/
โโโ balancer/
โ   โโโ nginx.conf
โโโ docker/
โ   โโโ balancer/
โ   โ   โโโ balancer.Dockerfile
โ   โโโ frontend/
โ   โ   โโโ vue.dev.Dockerfile
โ   โ   โโโ vue.prod.Dockerfile
โ   โ   โโโ nginx.conf
โ   โโโ nginx/
โ   โ   โโโ nginx.Dockerfile
โ   โโโ php/
โ       โโโ php.Dockerfile
โ       โโโ php.ini
โ       โโโ php-fpm.conf
โ       โโโ conf.d/
โ       โ   โโโ session.redis.ini
โ       โโโ www.conf
โโโ frontend/
โ   โโโ src/
โ   โ   โโโ utils/
โ   โ   โ   โโโ emailGenerator.js
โ   โ   โโโ App.vue
โ   โ   โโโ main.js
โ   โโโ index.html
โ   โโโ vite.config.js
โ   โโโ package.json
โโโ nginx/
โ   โโโ conf.d/
โ   โ   โโโ default.conf
โ   โโโ nginx.conf
โโโ public/
โ   โโโ index.php
โโโ src/
โ   โโโ Router.php
โ   โโโ StatsCollector.php
โ   โโโ EmailValidator.php
โโโ tests/
โ   โโโ Unit/
โ   โ   โโโ EmailValidatorTest.php
โ   โโโ manual_test.php
โ   โโโ redis_test.php
โโโ vendor/
โโโ .gitignore
โโโ composer.json
โโโ docker-compose.yml
โโโ docker-compose.dev.yml
โโโ docker-compose.prod.yml
โโโ Makefile
โโโ README.md
```

## โ๏ธ ะะฐะบ ะทะฐะฟัััะธัั ะฟัะพะตะบั

### Dev-ัะตะถะธะผ

```bash
make dev-build
make dev-down
```

### Prod-ัะตะถะธะผ

```bash
make prod-up
make prod-down
```

### ะะพะผะฐะฝะดั Makefile

* `make dev-up`
* `make dev-down`
* `make dev-build`
* `make dev-rebuild`
* `make dev-logs`
* `make prod-up`
* `make prod-down`
* `make prod-build-local`
* `make prod-push`
* `make prod-logs`
* `make ps`

## ๐งช ะัะพะฒะตัะบะฐ ัะฐะฑะพัั

ะขะตััะธัะพะฒะฐะฝะธะต ะฒัะฟะพะปะฝัะตััั ัะตัะตะท ะฒะตะฑ-ะธะฝัะตััะตะนั ะฟะพ ะฐะดัะตัั [http://localhost](http://localhost):

๐ธ ะฒะฒะตะดะธัะต ัะฟะธัะพะบ email-ะฐะดัะตัะพะฒ (ะฟะพ ะพะดะฝะพะผั ะฝะฐ ัััะพะบั)
๐ธ ะพัะฟัะฐะฒััะต ะฝะฐ ะฒะตัะธัะธะบะฐัะธั
๐ธ ะฟะพะปััะธัะต ัะฟะธัะพะบ ะฒะฐะปะธะดะฝัั/ะฝะตะฒะฐะปะธะดะฝัั email ั ัะบะฐะทะฐะฝะธะตะผ ะฟัะธัะธะฝั
๐ธ ััะฐััั Redis Cluster ะพัะพะฑัะฐะถะฐะตััั ะฒะฝะธะทั ัััะฐะฝะธัั ะธ ะพะฑะฝะพะฒะปัะตััั ะบะฐะถะดัะต 30 ัะตะบัะฝะด

## ๐ ะะตัะธัะธะบะฐัะธั Email

ะะพะณะธะบะฐ ัะตะฐะปะธะทะพะฒะฐะฝะฐ ะฒ `src/EmailValidator.php` ะธ ะฒะบะปััะฐะตั:

* ะัะพะฒะตัะบั ัะพัะผะฐัะฐ email ัะตัะตะท ัะตะณัะปััะฝัะต ะฒััะฐะถะตะฝะธั
* ะัะพะฒะตัะบั ะฝะฐะปะธัะธั DNS MX-ะทะฐะฟะธัะธ ะดะพะผะตะฝะฐ
* ะะฑัะฐะฑะพัะบะฐ ะฟััััั ะธ ะฝะตะบะพััะตะบัะฝัั ัััะพะบ

ะคะพัะผะฐั ะพัะฒะตัะฐ:

* โ 200 OK โ ะฒะพะทะฒัะฐัะฐะตััั ัะฟะธัะพะบ email ั ัะปะฐะณะฐะผะธ "valid"/"invalid"
* โ 400 Bad Request โ ะตัะปะธ ะฒัะพะดะฝัะต ะดะฐะฝะฝัะต ะฝะตะฒะฐะปะธะดะฝั (ะฝะฐะฟัะธะผะตั, ะฟัััะพะน ัะฟะธัะพะบ)

## ๐ ะััะธัะตะบัััะฐ Nginx

ะะฐะปะฐะฝัะธัะพะฒัะธะบ ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตั ะทะฐะฟัะพัั ะผะตะถะดั backend ะธ frontend:

```nginx
upstream backend_upstream {
    server nginx-backend1:80;
    server nginx-backend2:80;
}

upstream frontend_upstream {
    server frontend:80;
}

location / {
    proxy_pass http://frontend_upstream;
    proxy_http_version 1.1;
}

location /api/ {
    proxy_pass http://backend_upstream;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

## ๐ก๏ธ ะกะตััะธะธ ะธ Redis Cluster

ะกะตััะธะธ ะธ ััะฐัะธััะธะบะฐ ัะพััะฐะฝััััั ะฒ Redis Cluster:

```
session.save_handler = rediscluster
session.save_path = "seed[]=redis-node1:6379&seed[]=redis-node2:6379&seed[]=redis-node3:6379&prefix=otus_hw06:"
```

Redis ะธัะฟะพะปัะทัะตััั ะดะปั:

* ะกะพััะฐะฝะตะฝะธั PHP-ัะตััะธะน
* ะกะฑะพัะฐ ััะฐัะธััะธะบะธ ะฟะพ email-ะฟัะพะฒะตัะบะฐะผ ัะตัะตะท `StatsCollector`

## โ ะัะฟะพะปะฝะตะฝะฝัะต ััะตะฑะพะฒะฐะฝะธั

* [x] Docker-ะบะพะฝัะตะนะฝะตัั: nginx, php-fpm, redis
* [x] POST-ะทะฐะฟัะพั `/api/verify-emails`
* [x] ะะฐะปะธะดะฐัะธั ัะพัะผะฐัะฐ email ะธ DNS-ะทะฐะฟะธัะตะน
* [x] ะะฐะปะฐะฝัะธัะพะฒะบะฐ ะผะตะถะดั backend-ะฐะผะธ
* [x] Redis Cluster ะดะปั ัะตััะธะน ะธ ััะฐัะธััะธะบะธ
* [x] ะะฐะทะดะตะปะตะฝะธะต dev ะธ prod ะพะบััะถะตะฝะธะน
* [x] Frontend-ะธะฝัะตััะตะนั ะฝะฐ Vue ั ะณะตะฝะตัะฐัะธะตะน email-ะดะฐะฝะฝัั
* [x] ะกะฑะพั ะธ ััะฐะฝะตะฝะธะต ััะฐัะธััะธะบะธ
* [x] ะะพะฝะธัะพัะธะฝะณ Redis Cluster

---

## ๐ฎ ะะฒัะพั

**Vladimir Matkovskii** โ [vlavlamat@icloud.com](mailto:vlavlamat@icloud.com)

---

ะัะปะธ ัะพัะตัั โ ั ะฟะพะทะถะต ะฟะพะผะพะณั ะฒะฝะตััะธ ะพะฑะฝะพะฒะปะตะฝะธั, ะบะพะณะดะฐ ะฟะพัะฒัััั ัะพัะฝัะต ะธะผะตะฝะฐ API-ัะฝะดะฟะพะธะฝัะพะฒ, ะบะปะฐััะพะฒ ะธะปะธ ะดะตัะฐะปะตะน ััะพะฝัะตะฝะดะฐ.
